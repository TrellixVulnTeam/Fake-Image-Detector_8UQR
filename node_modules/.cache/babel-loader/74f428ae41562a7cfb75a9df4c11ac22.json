{"ast":null,"code":"import _objectSpread from\"/home/tejeswar/VS_Workspace/fake-image-detector/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _createForOfIteratorHelper from\"/home/tejeswar/VS_Workspace/fake-image-detector/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _slicedToArray from\"/home/tejeswar/VS_Workspace/fake-image-detector/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"/home/tejeswar/VS_Workspace/fake-image-detector/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";var _excluded=[\"label\",\"updateFilesCb\",\"maxFileSizeInBytes\"];import React,{useRef,useState}from\"react\";import{FileUploadContainer,FormField,DragDropText,UploadFileBtn,FilePreviewContainer,ImagePreview,PreviewContainer,PreviewList,FileMetaData,RemoveFileIcon,InputLabel}from\"./file-upload.styles\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var KILO_BYTES_PER_BYTE=1000;var DEFAULT_MAX_FILE_SIZE_IN_BYTES=500000;var convertNestedObjectToArray=function convertNestedObjectToArray(nestedObj){return Object.keys(nestedObj).map(function(key){return nestedObj[key];});};var convertBytesToKB=function convertBytesToKB(bytes){return Math.round(bytes/KILO_BYTES_PER_BYTE);};var FileUpload=function FileUpload(_ref){var label=_ref.label,updateFilesCb=_ref.updateFilesCb,_ref$maxFileSizeInByt=_ref.maxFileSizeInBytes,maxFileSizeInBytes=_ref$maxFileSizeInByt===void 0?DEFAULT_MAX_FILE_SIZE_IN_BYTES:_ref$maxFileSizeInByt,otherProps=_objectWithoutProperties(_ref,_excluded);var fileInputField=useRef(null);var _useState=useState({}),_useState2=_slicedToArray(_useState,2),files=_useState2[0],setFiles=_useState2[1];var handleUploadBtnClick=function handleUploadBtnClick(){fileInputField.current.click();};var addNewFiles=function addNewFiles(newFiles){var _iterator=_createForOfIteratorHelper(newFiles),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var file=_step.value;if(file.size<=maxFileSizeInBytes){if(!otherProps.multiple){return{file:file};}files[file.name]=file;}}}catch(err){_iterator.e(err);}finally{_iterator.f();}return _objectSpread({},files);};var callUpdateFilesCb=function callUpdateFilesCb(files){var filesAsArray=convertNestedObjectToArray(files);updateFilesCb(filesAsArray);};var handleNewFileUpload=function handleNewFileUpload(e){var newFiles=e.target.files;if(newFiles.length){var updatedFiles=addNewFiles(newFiles);setFiles(updatedFiles);callUpdateFilesCb(updatedFiles);}};var removeFile=function removeFile(fileName){delete files[fileName];setFiles(_objectSpread({},files));callUpdateFilesCb(_objectSpread({},files));};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(FileUploadContainer,{children:[/*#__PURE__*/_jsx(InputLabel,{children:label}),/*#__PURE__*/_jsx(DragDropText,{children:\"Drag and drop your files anywhere or\"}),/*#__PURE__*/_jsxs(UploadFileBtn,{type:\"button\",onClick:handleUploadBtnClick,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-file-upload\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\" Upload \",otherProps.multiple?\"files\":\"a file\"]})]}),/*#__PURE__*/_jsx(FormField,_objectSpread({type:\"file\",ref:fileInputField,onChange:handleNewFileUpload,title:\"\",value:\"\"},otherProps))]}),/*#__PURE__*/_jsxs(FilePreviewContainer,{children:[/*#__PURE__*/_jsx(\"span\",{children:\"To Upload\"}),/*#__PURE__*/_jsx(PreviewList,{children:Object.keys(files).map(function(fileName,index){var file=files[fileName];var isImageFile=file.type.split(\"/\")[0]===\"image\";return/*#__PURE__*/_jsx(PreviewContainer,{children:/*#__PURE__*/_jsxs(\"div\",{children:[isImageFile&&/*#__PURE__*/_jsx(ImagePreview,{src:URL.createObjectURL(file),alt:\"file preview \".concat(index)}),/*#__PURE__*/_jsxs(FileMetaData,{isImageFile:isImageFile,children:[/*#__PURE__*/_jsx(\"span\",{children:file.name}),/*#__PURE__*/_jsxs(\"aside\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[convertBytesToKB(file.size),\" kb\"]}),/*#__PURE__*/_jsx(RemoveFileIcon,{className:\"fas fa-trash-alt\",onClick:function onClick(){return removeFile(fileName);}})]})]})]})},fileName);})})]})]});};export default FileUpload;","map":{"version":3,"sources":["/home/tejeswar/VS_Workspace/fake-image-detector/src/components/file-upload/file-upload.component.jsx"],"names":["React","useRef","useState","FileUploadContainer","FormField","DragDropText","UploadFileBtn","FilePreviewContainer","ImagePreview","PreviewContainer","PreviewList","FileMetaData","RemoveFileIcon","InputLabel","KILO_BYTES_PER_BYTE","DEFAULT_MAX_FILE_SIZE_IN_BYTES","convertNestedObjectToArray","nestedObj","Object","keys","map","key","convertBytesToKB","bytes","Math","round","FileUpload","label","updateFilesCb","maxFileSizeInBytes","otherProps","fileInputField","files","setFiles","handleUploadBtnClick","current","click","addNewFiles","newFiles","file","size","multiple","name","callUpdateFilesCb","filesAsArray","handleNewFileUpload","e","target","length","updatedFiles","removeFile","fileName","index","isImageFile","type","split","URL","createObjectURL"],"mappings":"gwBAAA,MAAOA,CAAAA,KAAP,EAAgBC,MAAhB,CAAwBC,QAAxB,KAAwC,OAAxC,CACA,OACEC,mBADF,CAEEC,SAFF,CAGEC,YAHF,CAIEC,aAJF,CAKEC,oBALF,CAMEC,YANF,CAOEC,gBAPF,CAQEC,WARF,CASEC,YATF,CAUEC,cAVF,CAWEC,UAXF,KAYO,sBAZP,C,6IAcA,GAAMC,CAAAA,mBAAmB,CAAG,IAA5B,CACA,GAAMC,CAAAA,8BAA8B,CAAG,MAAvC,CAEA,GAAMC,CAAAA,0BAA0B,CAAG,QAA7BA,CAAAA,0BAA6B,CAACC,SAAD,QACjCC,CAAAA,MAAM,CAACC,IAAP,CAAYF,SAAZ,EAAuBG,GAAvB,CAA2B,SAACC,GAAD,QAASJ,CAAAA,SAAS,CAACI,GAAD,CAAlB,EAA3B,CADiC,EAAnC,CAGA,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACC,KAAD,QAAWC,CAAAA,IAAI,CAACC,KAAL,CAAWF,KAAK,CAAGT,mBAAnB,CAAX,EAAzB,CAEA,GAAMY,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,MAKb,IAJJC,CAAAA,KAII,MAJJA,KAII,CAHJC,aAGI,MAHJA,aAGI,4BAFJC,kBAEI,CAFJA,kBAEI,gCAFiBd,8BAEjB,uBADDe,UACC,0CACJ,GAAMC,CAAAA,cAAc,CAAG9B,MAAM,CAAC,IAAD,CAA7B,CACA,cAA0BC,QAAQ,CAAC,EAAD,CAAlC,wCAAO8B,KAAP,eAAcC,QAAd,eAEA,GAAMC,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,EAAM,CACjCH,cAAc,CAACI,OAAf,CAAuBC,KAAvB,GACD,CAFD,CAIA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACC,QAAD,CAAc,0CACfA,QADe,YAChC,+CAA2B,IAAlBC,CAAAA,IAAkB,aACzB,GAAIA,IAAI,CAACC,IAAL,EAAaX,kBAAjB,CAAqC,CACnC,GAAI,CAACC,UAAU,CAACW,QAAhB,CAA0B,CACxB,MAAO,CAAEF,IAAI,CAAJA,IAAF,CAAP,CACD,CACDP,KAAK,CAACO,IAAI,CAACG,IAAN,CAAL,CAAmBH,IAAnB,CACD,CACF,CAR+B,qDAShC,wBAAYP,KAAZ,EACD,CAVD,CAYA,GAAMW,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACX,KAAD,CAAW,CACnC,GAAMY,CAAAA,YAAY,CAAG5B,0BAA0B,CAACgB,KAAD,CAA/C,CACAJ,aAAa,CAACgB,YAAD,CAAb,CACD,CAHD,CAKA,GAAMC,CAAAA,mBAAmB,CAAG,QAAtBA,CAAAA,mBAAsB,CAACC,CAAD,CAAO,CACjC,GAAeR,CAAAA,QAAf,CAA4BQ,CAAC,CAACC,MAA9B,CAAQf,KAAR,CACA,GAAIM,QAAQ,CAACU,MAAb,CAAqB,CACnB,GAAIC,CAAAA,YAAY,CAAGZ,WAAW,CAACC,QAAD,CAA9B,CACAL,QAAQ,CAACgB,YAAD,CAAR,CACAN,iBAAiB,CAACM,YAAD,CAAjB,CACD,CACF,CAPD,CASA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACC,QAAD,CAAc,CAC/B,MAAOnB,CAAAA,KAAK,CAACmB,QAAD,CAAZ,CACAlB,QAAQ,kBAAMD,KAAN,EAAR,CACAW,iBAAiB,kBAAMX,KAAN,EAAjB,CACD,CAJD,CAMA,mBACE,wCACE,MAAC,mBAAD,yBACE,KAAC,UAAD,WAAaL,KAAb,EADF,cAEE,KAAC,YAAD,mDAFF,cAGE,MAAC,aAAD,EAAe,IAAI,CAAC,QAApB,CAA6B,OAAO,CAAEO,oBAAtC,wBACE,UAAG,SAAS,CAAC,oBAAb,EADF,cAEE,mCAAeJ,UAAU,CAACW,QAAX,CAAsB,OAAtB,CAAgC,QAA/C,GAFF,GAHF,cAOE,KAAC,SAAD,gBACE,IAAI,CAAC,MADP,CAEE,GAAG,CAAEV,cAFP,CAGE,QAAQ,CAAEc,mBAHZ,CAIE,KAAK,CAAC,EAJR,CAKE,KAAK,CAAC,EALR,EAMMf,UANN,EAPF,GADF,cAiBE,MAAC,oBAAD,yBACE,mCADF,cAEE,KAAC,WAAD,WACGZ,MAAM,CAACC,IAAP,CAAYa,KAAZ,EAAmBZ,GAAnB,CAAuB,SAAC+B,QAAD,CAAWC,KAAX,CAAqB,CAC3C,GAAIb,CAAAA,IAAI,CAAGP,KAAK,CAACmB,QAAD,CAAhB,CACA,GAAIE,CAAAA,WAAW,CAAGd,IAAI,CAACe,IAAL,CAAUC,KAAV,CAAgB,GAAhB,EAAqB,CAArB,IAA4B,OAA9C,CACA,mBACE,KAAC,gBAAD,wBACE,uBACGF,WAAW,eACV,KAAC,YAAD,EACE,GAAG,CAAEG,GAAG,CAACC,eAAJ,CAAoBlB,IAApB,CADP,CAEE,GAAG,wBAAkBa,KAAlB,CAFL,EAFJ,cAOE,MAAC,YAAD,EAAc,WAAW,CAAEC,WAA3B,wBACE,sBAAOd,IAAI,CAACG,IAAZ,EADF,cAEE,sCACE,wBAAOpB,gBAAgB,CAACiB,IAAI,CAACC,IAAN,CAAvB,SADF,cAEE,KAAC,cAAD,EACE,SAAS,CAAC,kBADZ,CAEE,OAAO,CAAE,yBAAMU,CAAAA,UAAU,CAACC,QAAD,CAAhB,EAFX,EAFF,GAFF,GAPF,GADF,EAAuBA,QAAvB,CADF,CAsBD,CAzBA,CADH,EAFF,GAjBF,GADF,CAmDD,CAhGD,CAkGA,cAAezB,CAAAA,UAAf","sourcesContent":["import React, { useRef, useState } from \"react\";\nimport {\n  FileUploadContainer,\n  FormField,\n  DragDropText,\n  UploadFileBtn,\n  FilePreviewContainer,\n  ImagePreview,\n  PreviewContainer,\n  PreviewList,\n  FileMetaData,\n  RemoveFileIcon,\n  InputLabel\n} from \"./file-upload.styles\";\n\nconst KILO_BYTES_PER_BYTE = 1000;\nconst DEFAULT_MAX_FILE_SIZE_IN_BYTES = 500000;\n\nconst convertNestedObjectToArray = (nestedObj) =>\n  Object.keys(nestedObj).map((key) => nestedObj[key]);\n\nconst convertBytesToKB = (bytes) => Math.round(bytes / KILO_BYTES_PER_BYTE);\n\nconst FileUpload = ({\n  label,\n  updateFilesCb,\n  maxFileSizeInBytes = DEFAULT_MAX_FILE_SIZE_IN_BYTES,\n  ...otherProps\n}) => {\n  const fileInputField = useRef(null);\n  const [files, setFiles] = useState({});\n\n  const handleUploadBtnClick = () => {\n    fileInputField.current.click();\n  };\n\n  const addNewFiles = (newFiles) => {\n    for (let file of newFiles) {\n      if (file.size <= maxFileSizeInBytes) {\n        if (!otherProps.multiple) {\n          return { file };\n        }\n        files[file.name] = file;\n      }\n    }\n    return { ...files };\n  };\n\n  const callUpdateFilesCb = (files) => {\n    const filesAsArray = convertNestedObjectToArray(files);\n    updateFilesCb(filesAsArray);\n  };\n\n  const handleNewFileUpload = (e) => {\n    const { files: newFiles } = e.target;\n    if (newFiles.length) {\n      let updatedFiles = addNewFiles(newFiles);\n      setFiles(updatedFiles);\n      callUpdateFilesCb(updatedFiles);\n    }\n  };\n\n  const removeFile = (fileName) => {\n    delete files[fileName];\n    setFiles({ ...files });\n    callUpdateFilesCb({ ...files });\n  };\n\n  return (\n    <>\n      <FileUploadContainer>\n        <InputLabel>{label}</InputLabel>\n        <DragDropText>Drag and drop your files anywhere or</DragDropText>\n        <UploadFileBtn type=\"button\" onClick={handleUploadBtnClick}>\n          <i className=\"fas fa-file-upload\" />\n          <span> Upload {otherProps.multiple ? \"files\" : \"a file\"}</span>\n        </UploadFileBtn>\n        <FormField\n          type=\"file\"\n          ref={fileInputField}\n          onChange={handleNewFileUpload}\n          title=\"\"\n          value=\"\"\n          {...otherProps}\n        />\n      </FileUploadContainer>\n      <FilePreviewContainer>\n        <span>To Upload</span>\n        <PreviewList>\n          {Object.keys(files).map((fileName, index) => {\n            let file = files[fileName];\n            let isImageFile = file.type.split(\"/\")[0] === \"image\";\n            return (\n              <PreviewContainer key={fileName}>\n                <div>\n                  {isImageFile && (\n                    <ImagePreview\n                      src={URL.createObjectURL(file)}\n                      alt={`file preview ${index}`}\n                    />\n                  )}\n                  <FileMetaData isImageFile={isImageFile}>\n                    <span>{file.name}</span>\n                    <aside>\n                      <span>{convertBytesToKB(file.size)} kb</span>\n                      <RemoveFileIcon\n                        className=\"fas fa-trash-alt\"\n                        onClick={() => removeFile(fileName)}\n                      />\n                    </aside>\n                  </FileMetaData>\n                </div>\n              </PreviewContainer>\n            );\n          })}\n        </PreviewList>\n      </FilePreviewContainer>\n    </>\n  );\n};\n\nexport default FileUpload;\n"]},"metadata":{},"sourceType":"module"}